<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
    />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/style-commun.css" />
  <link rel="stylesheet" href="styles/style-code.css" />
  <title>D√©partement IT ‚Äì B2MS CleanTech</title>
</head>
<body>
  <header class="header">
    <div class="section__container header__container_domaine">
      <h2>D√©partement IT</h2>
    </div>
  </header>

  <div class="layout-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
      </div>

      <nav class="main-nav">
        <a href="./" class="nav-link"><i class="fas fa-home"></i> Accueil</a>

        <div class="nav-section">
          <a href="./it" style="text-decoration: none;"><button class="tab-button active"><i class="fas fa-desktop"></i> IT</button> </a>       
          
          <div class="sub-links">
            <a href="./it-projet1" class="subtab-button">Projet 1</a>

            <a href="./it-projet2" class="subtab-button active">Projet 2</a>
              <nav class="project-subnav active" id="subnav-test2">
                <a href="#1-test2">1. Contexte et objectifs</a>
                <a href="#2-test2">2. Technologies utilis√©es</a>
                <a href="#3-test2">3. Structure du package et fonctionnement</a>
                <a href="#4-test2">4. Tests r√©alis√©s</a>
                <a href="#5-test2">5. Limites et perspectives</a>
                <a href="#6-test2">6. Conclusion</a>
                <a href="#7-test2">7. Ressources utiles</a>
                <a href="#8-test2">8. Bonus</a>
              </nav>

            <a href="./it-projet3" class="subtab-button">Projet 3</a>
          </div>
        </div>

        <a href="./electronique" class="nav-link"><i class="fas fa-microchip"></i> √âlectronique</a>
        <a href="./mecanique" class="nav-link"><i class="fas fa-cogs"></i> M√©canique</a>
        <a href="./convoyeur" class="nav-link"></i><i class="fas fa-robot"></i> Convoyeur</a>
      </nav>
    </div>

    <!-- Contenu principal -->
    <main class="main-content">
      <section id="it-content" class="tab-content active">

        <div id="test2" class="subtab-content active">
          <h2 id="projet2" class="projet-titre">Projet 2 ‚Äì Introduction √† ROS2</h2>

          <h3 id="1-test2">1. Contexte et objectifs:</h3>

          <p>
            Ce projet introduit les m√©canismes fondamentaux de publication
            et de souscription dans le framework <strong>ROS2</strong> √† travers un exemple
            pratique de g√©n√©ration et d‚Äô√©valuation de donn√©es de capteurs.
          </p>
          <p>   
            L'objectif est de cr√©er un package ROS2 nomm√© <strong>sensor_data_evaluation</strong> contenant :
          </p>
          <ul>
            <li>Un <strong>node publisher</strong> qui publie toutes les 0,5 secondes des donn√©es simul√©es (temp√©rature, humidit√©, pression).</li>
            <li>Un <strong>node subscriber</strong> qui re√ßoit ces donn√©es et v√©rifie qu'elles sont dans les plages pr√©d√©finies, en affichant les r√©sultats dans le log.</li>
            <li>Un <strong>fichier de lancement</strong> pour tout ex√©cuter.</li>
          </ul>

          <h3 id="2-test2">2. Technologies utilis√©es</h3>
          <ul>
            <li><strong>ROS2 Humble</strong> qui publie toutes les 0,5 secondes des donn√©es simul√©es (temp√©rature, humidit√©, pression).</li>
            <li><strong>C++</strong> et les libraries telles <strong>rclcpp, std_msgs</strong>
            <li>Un <strong>fichier de lancement</strong> pour tout ex√©cuter.</li>
          </ul>

          <h3  id="3-test2">3. Structure du package et fonctionnement</h3>
          <p>
            Le package <strong>sensor_data_evaluation</strong> est compos√© de deux nodes:
          </p>
          <ul>
            <li><strong>sensor_node_publisher</strong></li>
            <li><strong>sensor_node_subscriber</strong></li>
          </ul>

          <h4><strong>a. Cr√©ation du workspace</strong></h4>
          <div class="code-container">
            <div class="btn-bar">
              <button onclick="copierCode('test2_T1', this)">üìã</button>
            </div>
            <pre><code id="test2_T1">
  user@user-VirtualBox:~$ cd Desktop
  user@user-VirtualBox:~/Desktop$ mkdir -p workspace/src
            </code></pre>
          </div>

          <h4><strong>b. Cr√©ation du package et des nodes</strong></h4>
          <div class="code-container">
            <div class="btn-bar">
              <button onclick="copierCode('test2_T2', this)">üìã</button>
            </div>
            <pre><code id="test2_T2">
    user@user-VirtualBox:~/Desktop$ cd workspace/src
    user@user-VirtualBox:~/Desktop/workspace/src$ ros2 pkg create sensor_data_evaluation --build-type ament_cmake
    going to create a new package
    package name: sensor_data_evaluation
    destination directory: /home/user/Desktop/workspace/src
    package format: 3
    version: 0.0.0
    description: TODO: Package description
    maintainer: [&apos;user &lt;user@todo.todo&gt;&apos;]
    licenses: [&apos;TODO: License declaration&apos;]
    build type: ament_cmake
    dependencies: []
    creating folder ./sensor_data_evaluation
    creating ./sensor_data_evaluation/package.xml
    creating source and include folder
    creating folder ./sensor_data_evaluation/src
    creating folder ./sensor_data_evaluation/include/sensor_data_evaluation
    creating ./sensor_data_evaluation/CMakeLists.txt

    [WARNING]: Unknown license &apos;TODO: License declaration&apos;.  This has been set in the package.xml, but no LICENSE file has been created.
    It is recommended to use one of the ament license identitifers:
    Apache-2.0
    BSL-1.0
    BSD-2.0
    BSD-2-Clause
    BSD-3-Clause
    GPL-3.0-only
    LGPL-3.0-only
    MIT
    MIT-0
    user@user-VirtualBox:~/Desktop/workspace/src$ ls
    sensor_data_evaluation
    user@user-VirtualBox:~/Desktop/workspace/src$ cd sensor_data_evaluation
    user@user-VirtualBox:~/Desktop/workspace/src/sensor_data_evaluation$ ls
    CMakeLists.txt  include  package.xml  src
    user@user-VirtualBox:~/Desktop/workspace/src/sensor_data_evaluation$ cd src
    user@user-VirtualBox:~/Desktop/workspace/src/sensor_data_evaluation/src$ chmod +x data_node_publisher.cpp
    user@user-VirtualBox:~/Desktop/workspace/src/sensor_data_evaluation/src$ chmod +x data_node_subscriber.cpp
    chmod: cannot access &apos;data_node_subscriber.cpp&apos;: No such file or directory
    user@user-VirtualBox:~/Desktop/workspace/src/sensor_data_evaluation/src$ touch data_node_publisher.cpp
    user@user-VirtualBox:~/Desktop/workspace/src/sensor_data_evaluation/src$ touch data_node_subscriber.cpp
    user@user-VirtualBox:~/Desktop/workspace/src/sensor_data_evaluation/src$ chmod +x data_node_subscriber.cpp
    user@user-VirtualBox:~/Desktop/workspace/src/sensor_data_evaluation/src$ ls
    data_node_publisher.cpp  data_node_subscriber.cpp
            </code></pre>
          </div>
          
          <p>Les nodes sont dans le dossier <strong>workspace/src/sensor_data_evaluation/src</strong>.</p>
          
          <h4><strong>c. sensor_node_publisher</strong></h4>
          <p>
            Ce node publie des donn√©es al√©atoires toutes les 0.5 secondes sur le topic <strong>/sensor_data</strong>:
          </p>
          <ul>
            <li>Temp√©rature : 15¬∞C √† 35¬∞C</li>
            <li>Humidit√© : 30% √† 70%</li>
            <li>Pression : 950 hPa √† 1050 hPa</li>
          </ul>

          <div class="code-container">
            <p>
              <strong>sensor_node_publisher.cpp</strong>
            </p>
            <div class="btn-bar">
              <button onclick="copierCode('sensor_node_publisher-cpp', this)">üìã</button>
              <button onclick="telechargerCode('sensor_node_publisher-cpp', 'sensor_node_publisher.cpp', 'text/x-c++src', this)">ü°á</button>
               </div>
            <pre><code id="sensor_node_publisher-cpp">
    #include &lt;chrono&gt;
    #include &lt;functional&gt;
    #include &lt;memory&gt;
    #include &lt;string&gt;
    #include &lt;random&gt;

    #include "rclcpp/rclcpp.hpp"
    #include "std_msgs/msg/string.hpp"

    using namespace std::chrono_literals;


    class SensorPublisher : public rclcpp::Node
    {
    private:
      rclcpp::TimerBase::SharedPtr timer_;
      rclcpp::Publisher&lt;std_msgs::msg::String&gt;::SharedPtr publisher_;
      int temp, pression, hum;
      // float temp, pression, hum;
      void timer_callback()
      {
        temp = nbr_generator(15, 35);
        hum = nbr_generator(30, 70);
        pression = nbr_generator(950, 1050);
        auto message = std_msgs::msg::String();
        message.data = "T = " + std::to_string(temp) + "¬∞C, H = " + std::to_string(hum) + "%, P = " + std::to_string(pression) + "hPa";
        RCLCPP_INFO(this->get_logger(), "Publishing: '%s'", message.data.c_str());
        publisher_->publish(message);
      }

      int nbr_generator(int min_value, int max_value){
        static std::random_device rd;
        static std::mt19937 gen(rd());
        std::uniform_int_distribution&lt;int&gt; distrib(min_value, max_value);

        return distrib(gen);
    }


    public:
      SensorPublisher()
      : Node("sensor_node_publisher")
      {
        publisher_ = this->create_publisher&lt;std_msgs::msg::String&gt;("sensor_data", 10);
        timer_ = this->create_wall_timer(
          500ms, std::bind(&SensorPublisher::timer_callback, this));
      }
    };

    int main(int argc, char * argv[])
    {
      rclcpp::init(argc, argv);
      rclcpp::spin(std::make_shared&lt;SensorPublisher&gt;());
      rclcpp::shutdown();
      return 0;
    }
            </code></pre>
          </div>

          <h4><strong>d. sensor_node_subscriber</strong></h4>
          <p>
            Ce node √©coute le topic <strong>/sensor_data</strong> et v√©rifie que les donn√©es sont dans la bonne plage.
          </p>
          <p>
            Il affiche dans le log les donn√©es r√©√ßues et un message indiquant si les valeurs sont correctes ou non.
          </p>
        
          <div class="code-container">
            <p>
              <strong>sensor_node_subscriber.cpp</strong>
            </p>
            <div class="btn-bar">
              <button onclick="copierCode('sensor_node_subscriber-cpp', this)">üìã</button>
              <button onclick="telechargerCode('sensor_node_subscriber-cpp', 'sensor_node_subscriber.cpp', 'text/x-c++src', this)">ü°á</button>
               </div>
            <pre><code id="sensor_node_subscriber-cpp">
    #include &lt;functional&gt;
    #include &lt;memory&gt;
    #include &lt;sstream&gt;

    #include "rclcpp/rclcpp.hpp"
    #include "std_msgs/msg/string.hpp"

    using std::placeholders::_1;

    class SensorSubscriber : public rclcpp::Node
    {
    public:
      SensorSubscriber()
      : Node("sensor_node_subscriber")
      {
        subscription_ = this->create_subscription&lt;std_msgs::msg::String&gt;(
          "sensor_data", 10, std::bind(&SensorSubscriber::sensor_callback, this, _1));
      }

    private:
      void sensor_callback(const std_msgs::msg::String & msg) const
      {
        // std::string message = "Data received: " + msg.data + ": " + is_correct_value(msg.data);
        // RCLCPP_INFO(this->get_logger(), "%s", message.c_str());
        RCLCPP_INFO(this->get_logger(), "Data received: %s : %s", msg.data.c_str(), (is_correct_value(msg.data)).c_str());
      }
      rclcpp::Subscription&lt;std_msgs::msg::String&gt;::SharedPtr subscription_;

      std::string is_correct_value(const std::string &txt) const{
        std::stringstream ss(txt);
        std::string buffer;
        int T, H, P;

        ss >> buffer >> buffer >> T >> buffer  
          >> buffer >> buffer >> H >> buffer 
          >> buffer >> buffer >> P >> buffer;
        
        return (15 <= T && T <= 35 && 30 <= H && H <= 70 && 950 <= P && P <= 1050)? "correct values":"incorrect values";
    }
    };


    int main(int argc, char * argv[])
    {
      rclcpp::init(argc, argv);
      rclcpp::spin(std::make_shared&lt;SensorSubscriber&gt;());
      rclcpp::shutdown();
      return 0;
    }
            </code></pre>
          </div>


          <h4><strong>e. CMakeLists.txt </strong></h4>
          <p>
            Ce fichier permet notamment de cr√©er les executables pour les nodes.
          </p>
          
          <div class="code-container">
            <p>
              <strong>CMakeLists.txt</strong>
            </p>
            <div class="btn-bar">
              <button onclick="copierCode('CMakeLists-txt', this)">üìã</button>
              <button onclick="telechargerCode('CMakeLists-txt', 'CMakeLists.txt', 'text/txt', this)">ü°á</button>
               </div>
            <pre><code id="CMakeLists-txt">
    cmake_minimum_required(VERSION 3.8)
    project(sensor_data_evaluation)

    if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES "Clang")
      add_compile_options(-Wall -Wextra -Wpedantic)
    endif()

    # find dependencies
    find_package(ament_cmake REQUIRED)
    find_package(rclcpp REQUIRED)
    find_package(std_msgs REQUIRED)

    # add the executable
    add_executable(sensor_node_publisher src/sensor_node_publisher.cpp)
    target_link_libraries(sensor_node_publisher PUBLIC rclcpp::rclcpp ${std_msgs_TARGETS})

    add_executable(sensor_node_subscriber src/sensor_node_subscriber.cpp)
    target_link_libraries(sensor_node_subscriber PUBLIC rclcpp::rclcpp ${std_msgs_TARGETS})

    install(TARGETS
      sensor_node_publisher
      sensor_node_subscriber
      DESTINATION lib/${PROJECT_NAME})


    if(BUILD_TESTING)
      find_package(ament_lint_auto REQUIRED)
      # the following line skips the linter which checks for copyrights
      # comment the line when a copyright and license is added to all source files
      set(ament_cmake_copyright_FOUND TRUE)
      # the following line skips cpplint (only works in a git repo)
      # comment the line when this package is in a git repo and when
      # a copyright and license is added to all source files
      set(ament_cmake_cpplint_FOUND TRUE)
      ament_lint_auto_find_test_dependencies()
    endif()

    ament_package()
            </code></pre>
          </div>

          <h4><strong>f. package.xml </strong></h4>
          <p>
            Ce fichier permet d'inclure les ressources n√©cessaires pour le package.
          </p>

          <div class="code-container">
            <p>
              <strong>package.xml</strong>
            </p>
            <div class="btn-bar">
              <button onclick="copierCode('package-xml', this)">üìã</button>
              <button onclick="telechargerCode('package-xml', 'package.xml', 'text/xml', this)">ü°á</button>
               </div>
            <pre><code id="package-xml">
    &lt;?xml version="1.0"?&gt;
    &lt;?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?&gt;

    &lt;package format="3"&gt;
      &lt;name&gt;sensor_data_evaluation&lt;/name&gt;
      &lt;version&gt;0.0.0&lt;/version&gt;
      &lt;description&gt;Sending and receiving data&lt;/description&gt;
      &lt;maintainer email="user@todo.todo"&gt;user&lt;/maintainer&gt;
      &lt;license&gt;TODO: License declaration&lt;/license&gt;

      &lt;buildtool_depend&gt;ament_cmake&lt;/buildtool_depend&gt;
      &lt;depend&gt;rclcpp&lt;/depend&gt;
      &lt;depend&gt;std_msgs&lt;/depend&gt;
      
      &lt;exec_depend&gt;ros2launch&lt;/exec_depend&gt;

      &lt;test_depend&gt;ament_lint_auto&lt;/test_depend&gt;
      &lt;test_depend&gt;ament_lint_common&lt;/test_depend&gt;

      &lt;export&gt;
        &lt;build_type&gt;ament_cmake&lt;/build_type&gt;
      &lt;/export&gt;
    &lt;/package&gt;
            </code></pre>
          </div>

        <h4><strong>g. Le fichier de lancement</strong></h4>
          <p>
            Nous avons opt√© pour un fichier xml pour sa facilit√© de prise en main.
          </p>
          <p>
            Ce fichier se trouve dans: workspace/install/sensor_data_evaluation/share/sensor_data_evaluation
          </p>

          <div class="code-container">
            <p>
              <strong>sensor_data_eval_launch.xml</strong>
            </p>
            <div class="btn-bar">
              <button onclick="copierCode('sensor_data_eval_launch-xml', this)">üìã</button>
              <button onclick="telechargerCode('sensor_data_eval_launch-xml', 'sensor_data_eval_launch.xml', 'text/xml', this)">ü°á</button>
               </div>
            <pre><code id="sensor_data_eval_launch-xml">
    &lt;?xml version="1.0" encoding="UTF-8"?&gt;
    &lt;launch&gt;
      &lt;node pkg="sensor_data_evaluation" exec="sensor_node_publisher"/&gt;
      &lt;node pkg="sensor_data_evaluation" exec="sensor_node_subscriber"/&gt;
    &lt;/launch&gt;
            </code></pre>
          </div>


        <h3  id="4-test2">4. Tests r√©alis√©s </h3>
            <p>
              <strong>Compilation du package</strong> par <strong>colcon</strong>
              et <strong>lancement des nodes</strong> via le launcher:
            </p>
              <div class="code-container">
                <div class="btn-bar">
                  <button onclick="copierCode('test2_T3', this)">üìã</button>
            </div>
            <pre><code id="test2_T3">
  user@user-VirtualBox:~$ cd Desktop/workspace
  user@user-VirtualBox:~/Desktop/workspace$ colcon build --symlink-install
  user@user-VirtualBox:~/Desktop/workspace$ source install/setup.bash
  user@user-VirtualBox:~/Desktop/workspace$ ros2 launch sensor_data_evaluation sensor_data_eval_launch.xml
                </code></pre>
              </div>
              
          <video controls width=auto>
            <source src="videos/Test2/IT/demo.mp4" type="video/mp4">
            Votre navigateur ne supporte pas la vid√©o HTML5.
          </video>
       
          
          <h3 id="5-test2">5. Limites et perspectives</h3>
            <p>
              En utilisant un launcher.xml, les deux nodes s'ex√©cutent sur le m√™me terminal
              ce qui rend difficile la lecture.
            </p>
            <p>
              Pour ne pas encombrer davantage l'affichage, nous avons opt√© pour des donn√©es enti√®res
              et une notification simple pour la v√©rification des plages des donn√©es.
            </p>
          
            <p>
              Pour r√©soudre ce probl√®me, d'autres formats alternatifs existent pour le fichier
              de lancement tel que le format <strong>.py</strong>. 
            </p>

        <h3 id="6-test2">6. Conclusion</h3>    
          <p>
            Ce projet a permis de mettre en ≈ìuvre de mani√®re concr√®te les m√©canismes de publication
            et de souscription dans ROS2 √† travers un exemple simple mais repr√©sentatif d‚Äôun syst√®me de capteurs.
            En simulant des donn√©es environnementales (temp√©rature, humidit√© et pression) et en les √©valuant en temps r√©el,
            nous avons pu r√©pondre au cahier de charge.
          </p>
        
          <p>
            Ce projet repr√©sente une √©tape cl√© dans l‚Äôapprentissage du framework ROS2
            et de son √©cosyst√®me autour de la robotique distribu√©e.
          </p>

          <h3  id="7-test2">7. Ressources utiles</h3>
            <p>
              ROS2 Documentation: <a href="https://docs.ros.org/en/kilted/index.html" target="_blank">https://docs.ros.org/en/kilted/index.html</a>
            </p>

          <h3  id="8-test2">8. Bonus</h3>
            <p>
              Voici une vid√©o montrant la connexion entre un <strong>node publisher</strong>
              sur une <strong>machine A</strong> et un <strong>node subscriber</strong>
              sur une <strong>machine B</strong>:
            </p>
            <video controls width=auto>
              <source src="videos/Test2/IT/bonus.mp4" type="video/mp4">
              Votre navigateur ne supporte pas la vid√©o HTML5.
            </video>
          
        </div>


      </section>
    </main>
  </div>

  <footer>
    Copyright ¬© 2025 Team B2MS CleanTech. All rights reserved.
  </footer>

  <script src="scripts/script_commun.js"></script>
  <script src="scripts/script_code.js"></script>
</body>
</html>
