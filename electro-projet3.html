<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
    />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/style-commun.css" />
  <link rel="stylesheet" href="styles/style-code.css" />
  <title>D√©partement √âlectronique</title>
</head>
<body>
  <header class="header">
    <div class="section__container header__container_domaine">
      <h2>D√©partement √âlectronique</h2>
    </div>
  </header>

  <div class="layout-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
      </div>

      <nav class="main-nav">
        <a href="./" class="nav-link"><i class="fas fa-home"></i> Accueil</a>

        <div class="nav-section">
          <a href="./it" class="nav-link"><i class="fas fa-desktop"></i> IT</a>
          <a href="./electronique" style="text-decoration: none;"><button class="tab-button active"><i class="fas fa-microchip"></i> √âlectronique</button> </a>       
          
          <div class="sub-links">
            <a href="./electro-projet1" class="subtab-button">Projet 1</a>
            <a class="subtab-button" href="./electro-projet2">Projet 2</a>
            <a class="subtab-button active" href="./electro-projet3">Projet 3</a>
            <nav class="project-subnav active" id="subnav-test3">
              <a href="#1-test3">1. Objectifs</a>
              <a href="#2-test3">2. Cahier des charges</a>
              <a href="#3-test3">3. Architecture G√©n√©rale</a>
              <a href="#4-test3">4. Fonctionnement global</a>
              <a href="#5-test3">5. Fonctionnement du Servomoteur</a>
              <a href="#6-test3">6. Utilisation de Servomoteurs</a>
              <a href="#7-test3">7. Biblioth√®que n√©cessaire</a>
              <a href="#8-test3">8. Code</a>
              <a href="#9-test3">9. Test et D√©monstration</a>
              <a href="#10-test3">10. Realisation du PCB</a>
            </nav>
          </div>
        </div>

        <a href="./mecanique" class="nav-link"><i class="fas fa-cogs"></i> M√©canique</a>
        <a href="./convoyeur" class="nav-link"></i><i class="fas fa-robot"></i> Convoyeur</a>
      </nav>
    </div>

    <!-- Contenu principal -->
    <main class="main-content">
      <section id="electro-content" class="tab-content active">
        <div id="test3" class="subtab-content active">
          <h2 id="projet3" class="projet-titre">Projet 3 - Afficheur 7 Segments √† Servomoteurs</h2>
            <h3 id="1-test3">1. Objectifs:</h3>
          <p>
            Cr√©er un afficheur 7 segments m√©canique utilisant **7 servomoteurs **, pilot√©s par un ATmega328P nu (sans carte Arduino), pour afficher les chiffres de 0 √† 9, puis de 9 √† 0. Le tout doit √™tre aliment√© par une batterie Li-ion, et le code doit √™tre non bloquant (sans delay()), avec un affichage toutes les secondes.
          </p>
          <p>
            Ce projet a pour objectif de :
          </p>
          <ul>
            <li>Comprendre le fonctionnement d‚Äôun capteur inertiel (IMU).</li>
            <li>afficher en temps r√©el les directions (haut, bas, gauche, droite) ainsi que les donn√©es d‚Äôacc√©l√©ration sur un √©cran LCD.</li>
            <li>Utiliser le protocole de communication I2C.</li>
            <li>Appliquer les bonnes pratiques de conception logicielle (structure modulaire, classes bien d√©finies, etc.).</li>
          </ul>

          <h3 id="2-test3">2. Cahier des charges</h3>
            <h4>Objectifs fonctionnels :</h4>
              <ul>
              <li>Cr√©er un afficheur 7 segments m√©canique utilisant <strong>des servomoteurs</strong>></li>
              <li>Contr√¥ler les servomoteurs avec un <strong>ATmega328P</strong></li>
              <li>G√©n√©rer un affichage fluide des chiffres de 0 √† 9 puis 9 √† 0, sans blocage</li>
              <li>Utiliser un signal PWM avec la biblioth√®que <strong>Servo.h</strong></li>
              <li>Concevoir un circuit imprim√© (PCB) optimis√© et compact</li>
              <li>Alimenter le syst√®me avec une batterie Li-ion via un <strong>r√©gulateur AMS1117</strong></li>
              </ul>
        
            <h4>Contraintes techniques :</h4>
              <ul>
              <li>Le syst√®me doit √™tre autonome (sans PC ni carte Arduino)</li>
              <li>Les segments doivent √™tre enti√®rement visibles m√©caniquement</li>
              <li>Aucun delay() ne doit √™tre utilis√© dans le code (gestion avec <strong>millis()</strong>)</li>
              <li>Le PCB doit int√©grer le r√©gulateur, le quartz, les r√©sistances et les condensateurs</li>
              <li>L‚Äôensemble doit √™tre test√© en simulation et en maquette avant production</li>
              </ul>

        <h3 id="3-test3">3. Architecture G√©n√©rale</h3>
          <h4>Mat√©riel Utilis√©:</h4>
              <ul>
              <li>Microcontr√¥leur: <strong>ATmega328P</strong></li>
              <li>Servomoteurs: <strong>SG90/Parallax</strong>(7)</li>
              <li>R√©gulateur: <strong>LM7805 5V</strong></li>
              <li>Quartz: <strong>16 MHz</strong></li>
              <li>Condensateurs: <strong>22pF</strong>(2)</li>
              <li>R√©sistance Pull-up: <strong>10kŒ© (reset)</strong></li>
              <li>Batterie Li-ion: <strong>3.7V</strong></li>
              <li>Veroboard</li>
              <li>Fils & connecteurs</li>
              </ul>

        <h3 id="4-test3">4. Fonctionnement global</h3>
          <p>
            Le principe de fonctionnement repose sur l‚Äôutilisation de 7 servomoteurs, chacun √©tant affect√© √† un segment de l‚Äôafficheur (de a √† g). Ces segments ne sont pas lumineux, mais d√©plac√©s m√©caniquement √† l‚Äôaide des bras des servomoteurs, ce qui cr√©e une repr√©sentation physique du chiffre souhait√©. Pour chaque chiffre (de 0 √† 9), une configuration particuli√®re des segments doit √™tre activ√©e ou d√©sactiv√©e. Cela signifie que certains servomoteurs se positionnent dans une position visible (par exemple 90¬∞ pour un segment ¬´ allum√© ¬ª) tandis que d‚Äôautres se r√©tractent (0¬∞ pour un segment ¬´ √©teint ¬ª). L‚Äôensemble est pilot√© par un microcontr√¥leur ATmega328P, qui g√©n√®re un signal PWM adapt√© √† chaque servo pour lui indiquer sa position. Le code est con√ßu pour √©viter toute fonction bloquante comme delay() ; les changements de chiffres sont g√©r√©s toutes les secondes √† l‚Äôaide de la fonction millis(), garantissant un comportement fluide et r√©actif du syst√®me. 
          </p>

        <h3 id="5-test3">5. Fonctionnement d√©taill√© du Servomoteur SG90</h3>
          <p>
            Un servomoteur est un moteur √©quip√© d‚Äôun r√©ducteur et d‚Äôun potentiom√®tre qui permet un contr√¥le pr√©cis de l‚Äôangle de rotation, g√©n√©ralement entre 0¬∞ et 180¬∞.
          </p>
          <div class="image-container">
            <img src="images/Test3/Electronique/image1.webp" alt="image" class="image-centree" />
          </div>

          <h4>Caract√©ristiques techniques du SG90</h4>
            <ul>
              <li>Dimensions: 22 x 11.5 x 27 mm</li>
              <li>Poids: 	9 g</li>
              <li>Tension d‚Äôalimentation: 4.8 V √† 6 V</li>
              <li>Vitesse: 0.12 s / 60¬∞</li>
              <li>Couple: 1.2 kg/cm</li>
              <li>Angle de rotation: 	0¬∞ √† 180¬∞</li>
            </ul>

            <h4>Signal PWM</h4>
            <p>
              Le servomoteur SG90 est command√© par un signal PWM (Pulse Width Modulation), qui est une suite d'impulsions r√©p√©t√©es p√©riodiquement. La largeur de l'impulsion (temps pendant lequel le signal est √† l'√©tat haut) d√©termine l'angle de positionnement du servomoteur.
            </p>
            <p>En g√©n√©ral :</p>
            <ul>
              <li>Une impulsion de 1 ms positionne l'axe √† 0¬∞ (gauche)</li>
              <li>Une impulsion de 1.5 ms positionne l'axe √† 90¬∞ (milieu)</li>
              <li>Une impulsion de 2 ms positionne l'axe √† 180¬∞ (droite)</li>
            </ul>
            <p>
              Ce signal est r√©p√©t√© <strong>toutes les 20 ms</strong>, soit une fr√©quence de 50 Hz. Le microcontr√¥leur doit maintenir cette fr√©quence et adapter la dur√©e de l'impulsion pour indiquer la position voulue. Si la fr√©quence est trop basse ou si le signal n‚Äôest pas stable, le servomoteur risque de vibrer ou de perdre sa position.
            </p>

            <div class="code-container">
            <p>Code_servo_basique.ino </p>
            <div class="btn-bar">
              <button onclick="copierCode('Code_servo_basique-ino', this)">üìã</button>
              <button onclick="telechargerCode('Code_servo_basique-ino', 'Code_servo_basique.ino', 'text/ino', this)">ü°á</button>
            </div>
            <pre><code id="Code_servo_basique-ino">
    // Test utilisation servomoteur SG90
    #include &lt;Servo.h&gt;
    Servo monservo; // Cr√©e l‚Äôobjet pour contr√¥ler le servomoteur

    void setup() {
      monservo.attach(9);     // Utilise la broche 9 pour le contr√¥le
      monservo.write(0);      // Positionne le servomoteur √† 0¬∞ (repos)
    }

    void loop() {
      // Boucle vide pour ce test
    }
            </code></pre>
            </div>

            <p>
            Ce code repr√©sente la toute premi√®re √©tape de l‚Äôutilisation d‚Äôun servomoteur. Il permet de l‚Äôattacher √† une broche num√©rique (ici D9) et de le positionner √† un angle pr√©cis (ici 0¬∞).
            Ce code utilise millis() pour g√©rer la temporisation, ce qui permet d'√©viter toute fonction bloquante comme delay().
            </p>
                
          <h3 id="6-test3">6. Utilisation de Deux Types de Servomoteurs (SG90 & Parallax)</h3>
            <p>
              Pendant le d√©veloppement, nous n‚Äôavons pas pu trouver 7 servomoteurs SG90 identiques. Pour contourner ce probl√®me, nous avons utilis√© une combinaison de servomoteurs SG90 et Parallax Continuous Rotation.
            </p>

            <h4>Adaptation du fonctionnement :</h4>
            <p>
              Les SG90 ont √©t√© utilis√©s normalement pour repr√©senter les segments ON/OFF via des angles pr√©cis.
              Les Parallax Continuous Rotation (rotation continue) ont √©t√© calibr√©s pour tourner bri√®vement dans un sens ou l‚Äôautre (ON ou OFF), puis s‚Äôarr√™ter.
            </p>

            <h4>Fonctionnement d√©taill√© du Servomoteur Parallax Continuous Rotation :</h4>
            <p>
              Ce type de servo ne peut pas se positionner √† un angle fixe. Il tourne dans un sens ou l‚Äôautre √† une certaine vitesse selon le signal PWM re√ßu.
            </p>

            <ul>
              <li>Caract√©ristiques techniques:</li>
              <ul>
                  <li>Type: Rotation continue</li>
                  <li>Tension: 4.8 ‚Äì 6 V</li>
                  <li>Signal neutre: 1500 ¬µs (arr√™t)</li>
                  <li>Vitesse max: ~60 tr/min</li>
                  <li>Contr√¥le: Par largeur d‚Äôimpulsion</li>
                  <li>Angle de positionnement: Non applicable</li>     
              </ul>
              <li>Signal de contr√¥le:</li>
              <ul>
                  <li>< 1500 ¬µs: Rotation sens horaire</li>
                  <li>> 1500 ¬µs: Rotation sens antihoraire</li>
                  <li>= 1500 ¬µs: Arr√™t (neutre)</li>    
              </ul>
              <li>Utilisation dans notre projet</li>
              <ul>
                  <li>ON: 1300 ¬µs pendant 200 m</li>
                  <li>OFF: 1700 ¬µs pendant 200 ms</li>
                  <li>Arr√™t: 1500 ¬µs</li>    
              </ul>
            </ul>
            <p>
              <strong>NB:</strong> Comme ces moteurs ne retournent pas √† une position fixe, chaque moteur a √©t√© calibr√© manuellement pour assurer l‚Äôalignement visuel des segments.
            </p>
      
          <h3 id="7-test3">7. Biblioth√®que n√©cessaire: <strong>Servo.h</strong></h3>  
            <p>
              La biblioth√®que <strong>Servo.h</strong> est une biblioth√®que native d'Arduino qui permet de contr√¥ler facilement les servomoteurs √† l‚Äôaide d‚Äôun signal PWM.
            </p>
            <p>Elle prend en charge :</p>
            <ul>
              <li>L‚Äôattachement d‚Äôun servomoteur √† une broche num√©rique via <strong>servo.attach(pin)</strong>;</li>
              <li>L‚Äôenvoi d‚Äôun angle de rotation avec <strong>servo.write(angle)</strong>;</li>
              <li>La gestion du signal PWM en arri√®re-plan sans que l‚Äôutilisateur ait √† le g√©n√©rer manuellement.</li>
            </ul>
            
            <p>
              Cette biblioth√®que est <strong>incluse par d√©faut</strong> avec l‚ÄôIDE Arduino. Aucun t√©l√©chargement suppl√©mentaire n‚Äôest n√©cessaire.
            </p>


          <h3 id="8-test3">8. Code Arduino (version multi-servos)</h3> 
            <p>
              Dans ce projet, le code Arduino est structur√© pour contr√¥ler 7 servomoteurs, chacun correspondant √† un segment (de a √† g) de l‚Äôafficheur 7 segments m√©canique.
            </p>
            <p>
              Voici les points cl√©s du code :
            </p>
            <ul>
              <li><strong>Utilisation de la biblioth√®que Servo.h</strong>:</li>
              <p>
                Cette biblioth√®que facilite le contr√¥le des servomoteurs en g√©n√©rant automatiquement le signal PWM n√©cessaire sur les broches num√©riques du microcontr√¥leur.
              </p>
              <li><strong>Cr√©ation de 7 objets Servo distincts</strong>: </li>
              <p>
                Chaque segment (a, b, c, d, e, f, g) est associ√© √† un objet Servo diff√©rent.
                Cela permet de commander individuellement chaque servomoteur en lui envoyant un angle sp√©cifique.
              </p>
              <li><strong>D√©finition d‚Äôun tableau chiffres[10][7]</strong>:</li>
              <p>
                Ce tableau contient la configuration des segments pour chaque chiffre de 0 √† 9.
              </p>
              <ul>
                <li>Chaque ligne du tableau correspond √† un chiffre.</li>
                <li>Chaque colonne correspond √† un segment (a √† g).</li>
                <li>La valeur 1 signifie que le segment doit √™tre activ√© (servo en position ¬´ ON ¬ª, par exemple 90¬∞).</li>
                <li>La valeur 0 signifie que le segment doit √™tre d√©sactiv√© (servo en position ¬´ OFF ¬ª, par exemple 0¬∞).</li>
              </ul>
              <p>
                Cela permet d‚Äôactiver ou d√©sactiver facilement les segments n√©cessaires pour afficher un chiffre donn√© en parcourant simplement ce tableau.
              </p>
              <li><strong>Gestion de la temporisation avec millis()</strong></li>
              <p>
                Pour que le programme reste r√©actif et √©vite les blocages, la fonction millis() est utilis√©e pour d√©clencher le changement de chiffre toutes les secondes.
              </p>
              <p>
                <strong>millis()</strong> retourne le nombre de millisecondes √©coul√©es depuis le d√©marrage du programme.
              </p>
              <p>
                En stockant la derni√®re valeur de millis() lors d‚Äôun changement, on peut comparer √† la valeur actuelle pour savoir quand une seconde s‚Äôest √©coul√©e sans utiliser delay().
              </p>
              <p>
                Cela permet au microcontr√¥leur de continuer √† g√©rer les servomoteurs et autres t√¢ches sans interruption ni blocage.
              </p>
            </ul>

            <div class="image-container">
              <img src="images/Test3/Electronique/tableau.webp" alt="image" class="image-centree" />
              <p>
                Tableau logique des chiffres (Segments activ√©s)
              </p>
            </div>
            <p>
              Chaque ligne correspond √† un chiffre et chaque colonne (a‚Äìg) repr√©sente un segment :
            </p>


            <div class="code-container">
            <p>Code_servo_7seg.ino </p>
            <div class="btn-bar">
              <button onclick="copierCode('Code_servo_7seg-ino', this)">üìã</button>
              <button onclick="telechargerCode('Code_servo_7seg-ino', 'Code_servo_7seg.ino', 'text/ino', this)">ü°á</button>
            </div>
            <pre><code id="Code_servo_7seg-ino">
    #include &lt;Servo.h&gt;  // Inclusion de la biblioth√®que standard Servo

    // D√©finition des angles pour contr√¥ler les segments
    #define ANGLE_ON  0     // Angle correspondant √† un segment "allum√©"
    #define ANGLE_OFF 90    // Angle correspondant √† un segment "√©teint"

    // D√©claration du nombre total de segments (7 segments A √† G)
    const int NUM_SEGMENTS = 7;

    // Tableau des broches reli√©es aux servomoteurs pour les segments A √† G
    const int servoPins[NUM_SEGMENTS] = {2, 3, 4, 5, 6, 7, 8};

    // Tableau d‚Äôobjets Servo, un pour chaque segment
    Servo servos[NUM_SEGMENTS];

    // D√©finition de l‚Äô√©tat ON (0¬∞) ou OFF (90¬∞) pour chaque chiffre de 0 √† 9
    // Chaque ligne correspond √† un chiffre, chaque colonne √† un segment : A B C D E F G
    const bool digits[10][7] = {
      {0, 0, 0, 1, 1, 1, 1}, // 0
      {1, 0, 0, 0, 0, 0, 1}, // 1
      {0, 0, 1, 1, 1, 0, 0}, // 2
      {0, 0, 0, 1, 0, 0, 0}, // 3
      {1, 0, 0, 0, 0, 1, 0}, // 4
      {0, 1, 0, 1, 0, 1, 0}, // 5
      {0, 1, 0, 1, 1, 1, 0}, // 6
      {0, 0, 0, 0, 0, 0, 1}, // 7
      {0, 0, 0, 1, 1, 1, 0}, // 8
      {0, 0, 0, 1, 0, 1, 0}  // 9
    };

    // Variables pour g√©rer la temporisation sans bloquer le code
    unsigned long previousMillis = 0;         // M√©morise le temps du dernier changement
    const unsigned long interval = 1000;      // Intervalle entre les changements (1 seconde)

    // Variables pour suivre le chiffre actuel et la direction du comptage
    int digit = 0;        // Chiffre actuellement affich√©
    int direction = 1;    // 1 = incr√©menter, -1 = d√©cr√©menter

    // Fonction d'initialisation : attache chaque servo √† sa broche
    void setup() {
      for (int i = 0; i < NUM_SEGMENTS; i++) {
        servos[i].attach(servoPins[i]);  // Initialise chaque servo
      }

      displayDigit(digit);  // Affiche le premier chiffre (0)
    }

    // Boucle principale qui s‚Äôex√©cute en continu
    void loop() {
      unsigned long currentMillis = millis();  // Temps √©coul√© depuis le d√©marrage

      // Si une seconde s'est √©coul√©e, on change de chiffre
      if (currentMillis - previousMillis >= interval) {
        previousMillis = currentMillis;  // Met √† jour le temps du dernier changement

        digit += direction;  // Incr√©mente ou d√©cr√©mente le chiffre

        // Si on d√©passe 9, on repart dans l'autre sens (compte √† rebours)
        if (digit > 9) {
          digit = 9;
          direction = -1;
        }

        // Si on descend en dessous de 0, on repart vers le haut
        else if (digit < 0) {
          digit = 0;
          direction = 1;
        }

        // Affiche le chiffre actuel sur les servos
        displayDigit(digit);
      }
    }

    // Fonction qui positionne les servos en fonction du chiffre √† afficher
    void displayDigit(int d) {
      for (int i = 0; i < NUM_SEGMENTS; i++) {
        // Si la valeur est 0 ‚Üí servo √† ANGLE_ON (segment allum√©)
        // Si la valeur est 1 ‚Üí servo √† ANGLE_OFF (segment √©teint)
        servos[i].write(digits[d][i] ? ANGLE_ON : ANGLE_OFF);
      }
    }
              </code></pre>
            </div>


          <h3 id="9-test3">9. Test et D√©monstration</h3>
          <video controls width=60%>
            <source src="videos/Test3/Electronique/video1.mp4" type="video/mp4">
            Votre navigateur ne supporte pas la vid√©o HTML5.
          </video>

          <h3 id="10-test3">10. Realisation du PCB</h3>
            <div class="image-container">
              <img src="images/Test3/Electronique/image2.webp" alt="image"/>
              <p>
                Cr√©ation du sch√©ma √©lectronique
              </p>
            </div>

            <div class="image-container">
              <img src="images/Test3/Electronique/image3.webp" alt="image"/>
              <p>
                Footprints
              </p>
            </div>

            <div class="image-container">
              <img src="images/Test3/Electronique/image4.webp" alt="image"/>
              <p>
                Organisation du PCB
              </p>
            </div>

            <div class="image-container">
              <img src="images/Test3/Electronique/image5.webp" alt="image"/>
              <p>
                D√©finition des contours du PCB (Edge Cuts)
              </p>
            </div>

            <div class="image-container">
              <img src="images/Test3/Electronique/image6.webp" alt="image"/>
              <p>
                Routage
              </p>
            </div>

            <div class="image-container">
              <img src="images/Test3/Electronique/image7.webp" alt="image"/>
              <p>
                Visualisation 3D du PCB
              </p>
            </div>

            <video controls width=60%>
              <source src="videos/Test3/Electronique/video2.mp4" type="video/mp4">
              Votre navigateur ne supporte pas la vid√©o HTML5.
            </video>

          <p class="txt_center">
            <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-B2MS_CleanTech-Docs/raw/refs/heads/main/Test3/Electronique/afficheur7segment.zip" target="_blank" class="download-link">t√©l√©charger les fichiers PCB</a>
          </p>
          
        </div>

      </section>
    </main>
  </div>

  <footer>
    Copyright ¬© 2025 Team B2MS CleanTech. All rights reserved.
  </footer>

  <script src="scripts/script_commun.js"></script>
  <script src="scripts/script_code.js"></script>
</body>
</html>
